var widgets=function(){function parseQuery(e){var t={};return"?"===e.charAt(0)&&(e=e.slice(1)),e.split("&").forEach(function(e){var n,o=e.split("="),r=o[0];2===o.length&&(n=o[1]),t[r]=n}),t}function loadScript(e){var t=document.createElement("script");t.src=e,(document.head||document.body).appendChild(t)}var widgets={preloaderURL:"/shared/images/preloader.gif",addToCart:function(e,t,n,o){var r=1;return t=Number(t),n=Number(n),$.post("/my/s3/export/shop/product.php",{mode:"json",action:"get-product",shop_id:e,product_id:t},function(i){if(widgets.isEmptyObject(i)&&"string"==typeof o.href)return location.href=o.href,!0;i&&void 0!=i.product_price&&(n=Number(i.product_price));var a=!0,d=r,s="1"==i.product_amount_limit;if(s&&(d=Number(i.product_amount),d<r&&(r=d)),!isNaN(e)&&e>0&&!isNaN(t)&&t>0&&!isNaN(n)&&!isNaN(r)&&r>0){var c,p,u,l="",f=!1,h=0,m=readCookie("CART_TOTAL_"+e),g=unescape(readCookie("CART_"+e)),y=g.split(";");isNaN(m)&&(m=Number(m));for(var w=0;w<y.length;w++)c=y[w].split("="),2==c.length&&(f||c[0]!=t?(""!=l&&(l+=";"),l=l+c[0]+"="+c[1],h+=Number(c[1])):(s&&c[1]>=d||(m=Number(m)+n*r),p=r+Number(c[1]),s&&p>d&&(p=d,a=!1,widgets.msg(window._s3Lang.JS_SHOP_PRODUCT_AMOUNT_TOTAL+": "+d,o)),f=!0,""!=l&&(l+=";"),l=l+t+"="+p,h+=p));return f||(""!=l&&(l+=";"),l=l+t+"="+r,m=Number(m)+n*r,h+=r),m=Math.round(100*m)/100,createCookie("CART_"+e,l,10),createCookie("CART_TOTAL_"+e,m,10),createCookie("CART_TOTAL_AMOUNT_"+e,h,10),u=document.getElementById("cart_total"),u&&(u.innerHTML=m),u=document.getElementById("cart_total_amount"),u&&(u.innerHTML=h),a&&widgets.msg(window._s3Lang.JS_ADDED,o),!0}},"json"),!1},formatPrice:function(e,t,n){"string"!=typeof e&&(e=String(e)),null==t&&(t=" "),null==n&&(n="."),"."!=n&&(e=e.replace(".",n));var o,r=e.split(n),i=[];if(r[0].length>=4){for(o=r[0].length-1,j=1;o>=0;--o,++j)i.unshift(r[0].charAt(o)),j%3==0&&o>0&&i.unshift(t);return i.join("")+(r[1]?n+r[1]:"")}return e},addOnloadEvent:function(e){var t=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){t&&t(),e()}},msg:function(e,t,n){if(t){var o=findPos(t),r=document.createElement("DIV");if(r){r.style.position="absolute",r.innerHTML=e,r.style.display="block",r.className=n?n:"added-to-cart",r.style.left=o.x+t.offsetWidth+"px",r.style.top=o.y+t.offsetHeight+"px";try{$(window).width()<=parseInt(r.style.left)+120&&(r.style.left=o.x-80+"px",r.style.top=o.y+t.offsetHeight+"px")}catch(i){}document.body.appendChild(r),window.setTimeout(function(){r&&r.parentNode&&r.parentNode.removeChild(r),delete r},1500)}}},createPreloader:function(node){var pos=findPos(node),div=document.createElement("div");with(div.style)position="absolute",display="block",left=pos.x+node.offsetWidth+"px",top=pos.y+node.offsetHeight+"px",width=32,height=32,background="url("+this.preloaderURL+") center center no-repeat transparent",zIndex=2e3;return div},addEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0}};window.findPos=function(e){var t={x:0,y:0};if(e.offsetParent)for(;e.offsetParent;)t.y+=e.offsetTop,t.x+=e.offsetLeft,e=e.offsetParent;else e.x&&(t.x+=e.x),e.y&&(t.y+=e.y);return t},String.prototype.trim=function(e){var t=e?e:"[\\t\\s\\n\\r]";return this.replace(new RegExp("^"+t+"+"),"").replace(new RegExp(t+"+$"),"")},widgets.addEvent(window.document,"keydown",function(e){e.altKey&&80==e.keyCode&&location.search.indexOf("profiling")==-1&&(location.search.indexOf("?")==-1?location.search+="?profiling="+Math.round(1e5*Math.random()):location.search+="&profiling="+Math.round(1e5*Math.random()))});var query=parseQuery(location.search);return("csspatch"in query||sessionStorage.getItem("csspatch"))&&(loadScript("/g/s3/csspatch/csspatch.client.js?_="+Date.now()),sessionStorage.setItem("csspatch",1)),widgets}();
//# sourceMappingURL=maps/widgets.js.map
